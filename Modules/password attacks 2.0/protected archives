ğŸ” Protected Archives - Breakdown
ğŸ§  What Are They?
Archives = compressed file containers (e.g., .zip, .rar, .7z)

Can store multiple files or even folders

Frequently used to organize and transfer multiple documents at once

Common in enterprise ops to bundle reports, creds, scripts, etc.

ğŸ” Can They Be Encrypted?
Yes, archives can be password-protected

Some formats natively support it (.zip, .rar, .7z)

Others use external tools (e.g., tar + openssl, gzip + gpg)

Still others are full-disk/volume encryption formats (e.g., BitLocker .vhd)

ğŸ§­ Recon/Enumeration Phase
During recon or credential hunting, run broad extension sweeps:

bash
Copy
Edit
find / -name *.<ext> 2>/dev/null
Or fetch extension lists dynamically:

bash
Copy
Edit
curl -s https://fileinfo.com/filetypes/compressed | html2text | awk '{print tolower($1)}' | grep "\." | tee -a compressed_ext.txt
ğŸ“¦ Archive Type: .zip â†’ Tool: zip2john + john
ğŸ§ª Step-by-Step:
ğŸ¯ Extract the hash from the zip:

bash
Copy
Edit
zip2john ZIP.zip > zip.hash
ğŸ” Inspect contents:

bash
Copy
Edit
cat zip.hash
ğŸ”“ Crack with a wordlist:

bash
Copy
Edit
john --wordlist=rockyou.txt zip.hash
âœ… View cracked password:

bash
Copy
Edit
john zip.hash --show
ğŸ“¦ Archive Type: gzip + openssl â†’ Tool: openssl brute loop
ğŸ§ª Step-by-Step:
ğŸ” Identify openssl-encrypted gzip:

bash
Copy
Edit
file GZIP.gzip
# Output: openssl enc'd data with salted password
ğŸ”“ Brute with a for-loop:

bash
Copy
Edit
for i in $(cat rockyou.txt); do
  openssl enc -aes-256-cbc -d -in GZIP.gzip -k $i 2>/dev/null | tar xz
done
âœ… Check if files were extracted:

bash
Copy
Edit
ls
ğŸ’½ Drive Type: BitLocker Encrypted VHD â†’ Tool: bitlocker2john + hashcat
ğŸ§ª Step-by-Step:
ğŸ§ª Extract hashes:

bash
Copy
Edit
bitlocker2john -i Backup.vhd > backup.hashes
grep "bitlocker\$0" backup.hashes > backup.hash
ğŸ”“ Crack with hashcat:

bash
Copy
Edit
hashcat -m 22100 backup.hash rockyou.txt -o backup.cracked
âœ… Read cracked password:

bash
Copy
Edit
cat backup.cracked
ğŸ§  Pro tip: Once cracked, mount the VHD on Windows, enter the password, and boom â€” access granted to the full encrypted volume.

ğŸ§¬ Mindset for Protected Archives
When	What to Do
Found .zip, .rar, .gzip, .vhd, .7z	Assume it could be encrypted
Archive opens but files inside are encrypted	Treat them individually with relevant *2john scripts
Not sure if encrypted?	Use file, binwalk, or try to extract and see
Can't open normally	Try hash extraction + cracking
Already cracked an archive	âœ… Look for more creds, configs, .kdbx, SSH keys, etc. inside
âš”ï¸ Attack Flow Mentality
pgsql
Copy
Edit
Recon â†’ Find archive â†’ Check if encrypted â†’ Extract hash â†’ Crack it â†’ Loot â†’ Reuse â†’ Escalate

ğŸ§­ When Youâ€™d Encounter These
During credential hunting sweeps:

find / -name *.zip, *.rar, *.vhd, etc.

Grepping for passwords, SSH keys, private data, or even just scanning user folders

Sometimes you find a .zip, .gzip, or .vhd and think:

â€œHmmâ€¦ canâ€™t open it... must be encrypted ğŸ‘€â€

ğŸ”“ Next Move = Bring Out John (or Hashcat)
Archive Type	Tool to Extract Hash	Tool to Crack
.zip, .rar, .7z	zip2john, rar2john, 7z2john.pl	john
.docx, .pdf, .xls	office2john.py, pdf2john.py	john
SSH Private Key	ssh2john.py	john
.vhd BitLocker Drive	bitlocker2john	hashcat
Encrypted .gzip via openssl	No hash, use openssl loop	N/A
ğŸ§  So the workflow =
vbnet
Copy
Edit
Find archive while hunting â†’ Check if it's locked â†’ Use a *2john tool â†’ Crack it with John or Hashcat â†’ Mount/extract/view â†’ Win
ğŸ´â€â˜ ï¸ Once Cracked?
Dump contents

Search for:

Passwords

SSH keys

More docs

Scripts

Config files

Chain it â†’ maybe use creds to SSH, WinRM, SMB, or impersonate someone else

ğŸ’¡ Pro Tip
A cracked .zip might have an encrypted .docx, and that might contain creds for a user with sudo rights â€” it's like peeling an onion of access.

