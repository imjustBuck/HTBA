Scenario
Our client Inlanefreight has contracted us again to perform a full-scope internal penetration test. The client is looking to find and remediate as many flaws as possible before going through a merger & acquisition process. The new CISO is particularly worried about more nuanced AD security flaws that may have gone unnoticed during previous penetration tests. The client is not concerned about stealth/evasive tactics and has also provided us with a Parrot Linux VM within the internal network to get the best possible coverage of all angles of the network and the Active Directory environment. Connect to the internal attack host via SSH (you can also connect to it using xfreerdp as shown in the beginning of this module) and begin looking for a foothold into the domain. Once you have a foothold, enumerate the domain and look for flaws that can be utilized to move laterally, escalate privileges, and achieve domain compromise.

Apply what you learned in this module to compromise the domain and answer the questions below to complete part II of the skills assessment.



xfreerdp /v:10.129.2.44 /u:htb-student /p:HTB_@cademy_stdnt! /drive:shared,/home/htb-ac-1235531/Desktop
SSH to 10.129.32.184 (ACADEMY-EA-PAR01-SA2) with user "htb-student" and password "HTB_@cademy_stdnt!"

Question 1 - Obtain a password hash for a domain user account that can be leveraged to gain a foothold in the domain. What is the account name?
1) ssh htb-student@10.129.32.184
2) ifconfig -a 
3) from output we know our network is 172.16.7.0/23
4) nmap -T5 -A 172.6.17.0/23 -> find 4 hosts -> inlanefreight.local (172.16.7.3) + 172.16.7.50 (MS01.INLANEFREIGHT.LOCAL) + 172.16.7.60 ( SQL01.INLANEFREIGHT.LOCAL) + 172.16.7.240 ( no DNS name, maybe web server? ) 
5) lets set up proxychains early for this one lol -> log out of ssh and re-login with ssh -D 9050 htb-student@10.129.32.184
6) good to go with proxychains. 
7) inside of the SSH session run -> sudo responder -I ens224 and wait for some hashes 





Question 2 - What is this user's cleartext password?




Question 3 -  Submit the contents of the C:\flag.txt file on MS01.



Question 4 - Use a common method to obtain weak credentials for another user. Submit the username for the user whose credentials you obtain.



Question 5 - What is this user's password?



Question 6 - Locate a configuration file containing an MSSQL connection string. What is the password for the user listed in this file?



Question 7 - Submit the contents of the flag.txt file on the Administrator Desktop on the SQL01 host.



Question 8 - Submit the contents of the flag.txt file on the Administrator Desktop on the MS01 host.



Question 9 - Obtain credentials for a user who has GenericAll rights over the Domain Admins group. What's this user's account name?



Question 10 -  Crack this user's password hash and submit the cleartext password as your answer.



Question 11 -  Submit the contents of the flag.txt file on the Administrator desktop on the DC01 host.


Question 12 -  Submit the NTLM hash for the KRBTGT account for the target domain after achieving domain compromise.
