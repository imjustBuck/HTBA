ðŸ§  Summary â€“ Bypassing Other Blacklisted Characters
Once injection operators like ;, &&, or characters like /, \, and space are blacklisted, we can still build payloads by:

âœ… Using environment variables
They're system variables that contain the characters we need, buried inside a longer string.

Then we slice out just the character we want using substring notation.

ðŸ”ª Techniques
ðŸ”¹ 1. Linux: Substring Extraction
Format: ${VAR:START:LENGTH}

${PATH:0:1} â†’ /
Because $PATH starts with /usr, so char at index 0 is /.

${LS_COLORS:10:1} â†’ ;
Because the LS_COLORS env var contains semicolons as delimiters.

Use Case in Payloads:

bash
Copy
Edit
127.0.0.1${LS_COLORS:10:1}${IFS}whoami
â†’ Effectively: 127.0.0.1; whoami â€” but without using ; or space directly.

ðŸ”¹ 2. Windows CMD: Substring Notation
Format: %ENVVAR:~START,LENGTH%

%HOMEPATH:~6,-11% â†’ \
E.g., if HOMEPATH is \Users\htb-student, this grabs the backslash.

Same trick â€” get characters without typing them directly.

ðŸ”¹ 3. Windows PowerShell: Character Indexing
PowerShell treats strings like arrays:

$env:HOMEPATH[0] â†’ \
Grabs first character from HOMEPATH

Also use:

powershell
Copy
Edit
Get-ChildItem Env:
To see all env vars, then extract specific characters using array indexing.

ðŸ”¹ 4. Character Shifting (Linux)
This oneâ€™s sick â€” works by:

Passing a character before the one we want

Using tr (translate) to shift ASCII one char forward

Example:

To get \ (ASCII 92), input [, which is ASCII 91:

bash
Copy
Edit
echo $(tr '!-}' '"-~'<<<[)
â© \ gets printed.

You can do the same for ;:

Find the character before ; in ASCII (which is :)

Use it in <<<: like:

bash
Copy
Edit
echo $(tr '!-}' '"-~'<<<:)
â© Will print ;

ðŸŒ± Patterns & Tips
ðŸ” Goal	ðŸ’¡ Technique	ðŸ’¬ Notes
Inject space	${IFS} or %09 or brace exp	Tabs work too
Inject semicolon ;	${LS_COLORS:10:1} or shifting	Confirm using echo
Inject slash /	${PATH:0:1}	Same for $PWD, $HOME
Windows slash \	%HOMEPATH:~6,-11% or [0]	Works in CMD and PowerShell
Any ASCII char	tr + ASCII shifting	Use man ascii to find positions
ðŸ§  ITTTT â€“ â€œGot This, Do Thatâ€
IF youâ€™re blocked by character filters (slash, semicolon, etc.)
THEN:

Use Linux env vars + slicing (${PATH:0:1})

Use ${IFS} or %09 for space/tab

Use ASCII shifting + tr (<<<: to get ;)

Use Windows PowerShell indexing ($env:VAR[0])

Use CMD substring logic (%VAR:~x,y%)

ðŸ’­ Bonus Hint
ðŸ”§ Use printenv (Linux) or Get-ChildItem Env: (PowerShell) to list all available variables and hunt down juicy chars already hiding in system paths.


ðŸ—‘ï¸ Why Windows Character Shifting is Kinda Trash
Windows CMD doesnâ€™t have anything like tr or Bash-style ASCII manipulation. Instead, you have to:

Find a string that contains the character you want (e.g. \ in %HOMEPATH%)

Slice it with :~start,length
Like:

cmd
Copy
Edit
echo %HOMEPATH:~6,-11%
Which is dumb because:

You have to know the lengths ahead of time

It varies system to system

You might get nothing back or cut too deep

ðŸ’€ Why It Sucks for Payloads
Itâ€™s unpredictable

Too context-specific

Takes longer to debug than it does to just spin up a Linux box and pwn from there

So if you're building command injection payloads, just hope the back-end is Linux ðŸ˜‚
If itâ€™s Windows, yeah â€” you can try that weird PowerShell index magic:

powershell
Copy
Edit
$env:HOMEPATH[0]
But even thatâ€™s clunky compared to Linux's IFS and substring slicing.

âœ… TL;DR
ðŸ’¬ "Chat, should I learn Windows character shifting?"
Nah.
Just know it exists, maybe memorize $env:VAR[x] for PowerShell, and if CPTS throws you into a Windows CMD-only box with a locked-down input field... we riot.


So yes â€” on the CPTS exam, if you sniff out that:

Itâ€™s a Windows box

Itâ€™s using PowerShell or CMD

And your inputs are crazy restricted (slashes, semicolons, spaces blacklisted...)

ðŸ‘‰ Just move on or use a simpler trick.
You might not even need full character bypasses â€” the exam doesnâ€™t typically punish you with ultra-obscure edge cases like â€œguess the exact index of a slash in HOMEPATHâ€ level weirdness.

ðŸ’¡ Pro Move:
If it gets that goofy, just ask yourself:

â€œWould this be faster to escalate from Linux or through another vuln I havenâ€™t checked yet?â€

Most of the time? Yup.

So yeah: youâ€™re allowed to hit the â€œnahâ€ button and move the hell on. Thatâ€™s strategy, not failure.

You ready to keep swinginâ€™?

