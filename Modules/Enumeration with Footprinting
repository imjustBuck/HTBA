#### Cheat Sheet 

Infrastructure-based Enumeration
Command	                                                                  Description
curl -s https://crt.sh/\?q\=<target-domain>\&output\=json | jq .	        Certificate transparency.
for i in $(cat ip-addresses.txt);do shodan host $i;done	                  Scan each IP address in a list using Shodan.

Host-based Enumeration
FTP
Command	                                                                  Description
ftp <FQDN/IP>	                                                            Interact with the FTP service on the target.
nc -nv <FQDN/IP> 21	                                                      Interact with the FTP service on the target.
telnet <FQDN/IP> 21	                                                      Interact with the FTP service on the target.
openssl s_client -connect <FQDN/IP>:21 -starttls ftp	                    Interact with the FTP service on the target using encrypted connection.
wget -m --no-passive ftp://anonymous:anonymous@<target>	                  Download all available files on the target FTP server.

SMB
Command	                                                                  Description
smbclient -N -L //<FQDN/IP>	                                              Null session authentication on SMB.
smbclient //<FQDN/IP>/<share>	                                            Connect to a specific SMB share.
rpcclient -U "" <FQDN/IP>	                                                Interaction with the target using RPC.
samrdump.py <FQDN/IP>	                                                    Username enumeration using Impacket scripts.
smbmap -H <FQDN/IP>	                                                      Enumerating SMB shares.
crackmapexec smb <FQDN/IP> --shares -u '' -p ''	                          Enumerating SMB shares using null session authentication.
enum4linux-ng.py <FQDN/IP> -A	                                            SMB enumeration using enum4linux.

NFS
Command	                                                                  Description
showmount -e <FQDN/IP>	                                                  Show available NFS shares.
mount -t nfs <FQDN/IP>:/<share> ./target-NFS/ -o nolock	                  Mount the specific NFS share to ./target-NFS
umount ./target-NFS	                                                      Unmount the specific NFS share.

DNS
Command	                                                                                                        Description
dig ns <domain.tld> @<nameserver>	                                                                              NS request to the specific nameserver.
dig any <domain.tld> @<nameserver>	                                                                            ANY request to the specific nameserver.
dig axfr <domain.tld> @<nameserver>	                                                                            AXFR request to the specific nameserver.
dnsenum --dnsserver <nameserver> --enum -p 0 -s 0 -o found_subdomains.txt -f ~/subdomains.list <domain.tld>	    Subdomain brute forcing.

SMTP
Command	                                                                  Description
telnet <FQDN/IP> 25	

IMAP/POP3
Command                                                                	Description
curl -k 'imaps://<FQDN/IP>' --user <user>:<password>	                  Log in to the IMAPS service using cURL.
openssl s_client -connect <FQDN/IP>:imaps	                              Connect to the IMAPS service.
openssl s_client -connect <FQDN/IP>:pop3s	                              Connect to the POP3s service.

SNMP
Command	                                                                Description
snmpwalk -v2c -c <community string> <FQDN/IP>	                          Querying OIDs using snmpwalk.
onesixtyone -c community-strings.list <FQDN/IP>	                        Bruteforcing community strings of the SNMP service.
braa <community string>@<FQDN/IP>:.1.*	                                Bruteforcing SNMP service OIDs.


MySQL
Command	                                                                Description
mysql -u <user> -p<password> -h <FQDN/IP>	                              Login to the MySQL server.


MSSQL
Command	                                                                Description
mssqlclient.py <user>@<FQDN/IP> -windows-auth	                          Log in to the MSSQL server using Windows authentication.

IPMI
Command	                                                                Description
msf6 auxiliary(scanner/ipmi/ipmi_version)	                              IPMI version detection.
msf6 auxiliary(scanner/ipmi/ipmi_dumphashes)	                          Dump IPMI hashes.


Linux Remote Management
Command	                                                              Description
ssh-audit.py <FQDN/IP>	                                              Remote security audit against the target SSH service.
ssh <user>@<FQDN/IP>	                                                Log in to the SSH server using the SSH client.
ssh -i private.key <user>@<FQDN/IP>	                                  Log in to the SSH server using private key.
ssh <user>@<FQDN/IP> -o PreferredAuthentications=password	            Enforce password-based authentication.


Windows Remote Management
Command	                                                              Description
rdp-sec-check.pl <FQDN/IP>	                                          Check the security settings of the RDP service.
xfreerdp /u:<user> /p:"<password>" /v:<FQDN/IP>	                      Log in to the RDP server from Linux.
evil-winrm -i <FQDN/IP> -u <user> -p <password>                      	Log in to the WinRM server.
wmiexec.py <user>:"<password>"@<FQDN/IP> "<system command>"	          Execute command using the WMI service.


Oracle TNS
Command	                                                                                                              Description
./odat.py all -s <FQDN/IP>	                                                                                          Perform a variety of scans to gather information about the Oracle database services and its components.
sqlplus <user>/<pass>@<FQDN/IP>/<db>                                                                                  Log in to the Oracle database.
./odat.py utlfile -s <FQDN/IP> -d <db> -U <user> -P <pass> --sysdba --putFile C:\\insert\\path file.txt ./file.txt	  Upload a file with Oracle RDBM

######## Enumeration Principles 

OSINT is an independent procedure and should be performed separately from enumeration because OSINT is based exclusively on passive information gathering and does not involve active enumeration of the given target.

Enumeration is a loop in which we repeatedly gather information based on what data we have or have already discovered.

Once we have identified targets in our client's infrastructure, we need to examine the individual services and protocols. 
In most cases, these are services that enable communication between customers, the infrastructure, the administration, and the employees.

!*!*!*!**!*! Our goal is not to get at the systems but to find all the ways to get there. !*!*!*!*!*!*!*

We wouldnt start hunting for treasure by just picking a shovel up and digging in a random spot, we would prepare for it. Gather materials, read maps, pack gear, learn the terrain. map it out and carefully plan out the "hunt" 

Things to think about beyond the actual information provided or gathered: 

What can we see?
What reasons can we have for seeing it?
What image does what we see create for us?
What do we gain from it?
How can we use it?
What can we not see?
What reasons can there be that we do not see?
What image results for us from what we do not see?

An important aspect that must not be confused here is that there are always exceptions to the rules. The principles, however, do not change. 
Another advantage of these principles is that we can see from the practical tasks that we do not lack penetration testing abilities but technical understanding when we suddenly do not know how to proceed because our core task is not to exploit the machines but to find how they can be exploited.

Principles: 

No.	Principle
1.	There is more than meets the eye. Consider all points of view.
2.	Distinguish between what we see and what we do not see.
3.	There are always ways to gain more information. Understand the target.


######### Enumeration Methodology 


Layer	                              Description	                                                                                               Information Categories
1. Internet Presence	              Identification of internet presence and externally accessible infrastructure.	                             Domains, Subdomains, vHosts, ASN, Netblocks, IP Addresses, Cloud Instances, Security Measures
2. Gateway	                        Identify the possible security measures to protect the company's external and internal infrastructure.	   Firewalls, DMZ, IPS/IDS, EDR, Proxies, NAC, Network Segmentation, VPN, Cloudflare
3. Accessible Services	            Identify accessible interfaces and services that are hosted externally or internally.	                     Service Type, Functionality, Configuration, Port, Version, Interface
4. Processes	                      Identify the internal processes, sources, and destinations associated with the services.	                 PID, Processed Data, Tasks, Source, Destination
5. Privileges	                      Identification of the internal permissions and privileges to the accessible services.	                     Groups, Users, Permissions, Restrictions, Environment
6. OS Setup	                        Identification of the internal components and systems setup.	                                             OS Type, Patch Level, Network config, OS Environment, Configuration files, sensitive private files


Important note: The human aspect and the information that can be obtained by employees using OSINT have been removed from the "Internet Presence" layer for simplicity.


Layer No.1: Internet Presence
The first layer we have to pass is the "Internet Presence" layer, where we focus on finding the targets we can investigate. If the scope in the contract allows us to look for additional hosts, this layer is even more critical than for fixed targets only. 
In this layer, we use different techniques to find domains, subdomains, netblocks, and many other components and information that present the presence of the company and its infrastructure on the Internet.

**********The goal of this layer is to identify all possible target systems and interfaces that can be tested.**********

Layer No.2: Gateway
Here we try to understand the interface of the reachable target, how it is protected, and where it is located in the network. Due to the diversity, different functionalities, and some particular procedures, we will go into more detail about this layer in other modules.

*******************The goal is to understand what we are dealing with and what we have to watch out for.

Layer No.3: Accessible Services
In the case of accessible services, we examine each destination for all the services it offers. Each of these services has a specific purpose that has been installed for a particular reason by the administrator. 
Each service has certain functions, which therefore also lead to specific results. To work effectively with them, we need to know how they work. Otherwise, we need to learn to understand them.

************This layer aims to understand the reason and functionality of the target system and gain the necessary knowledge to communicate with it and exploit it for our purposes effectively.

This is the part of enumeration we will mainly deal with in this module.

Layer No.4: Processes
Every time a command or function is executed, data is processed, whether entered by the user or generated by the system. This starts a process that has to perform specific tasks, and such tasks have at least one source and one target.

********************The goal here is to understand these factors and identify the dependencies between them.

Layer No.5: Privileges
Each service runs through a specific user in a particular group with permissions and privileges defined by the administrator or the system. These privileges often provide us with functions that administrators overlook. This often happens in Active Directory infrastructures and many other case-specific administration environments and servers where users are responsible for multiple administration areas.

****************It is crucial to identify these and understand what is and is not possible with these privileges.

Layer No.6: OS Setup
Here we collect information about the actual operating system and its setup using internal access. This gives us a good overview of the internal security of the systems and reflects the skills and capabilities of the company's administrative teams.

*************The goal here is to see how the administrators manage the systems and what sensitive internal information we can glean from them.
